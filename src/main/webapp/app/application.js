/*! admin 2017-04-27 */

Ext.define("Admin.controller.AppController",{extend:"Ext.app.Controller",namespace:"Admin",requires:[],stores:[],config:{control:{"#":{unmatchedroute:"onRouteChange"},"navigation-tree":{itemclick:"onNavigationTreeSelectionChange"},contentPanel:{beforeremove:"onContentPanelSubClose",tabchange:"positionedchange"}},refs:{viewport:"viewport",login:"login",navigationTree:"navigation-tree",contentPanel:"contentPanel",outsourceGrid:"#outsource",adInfoGrid:"outsource > adInfo-mgrid"},routes:{":node":"onRouteChange"}},lastView:null,loginViewType:"login",setCurrentView:function(a){a=a||"";var b,c=this,d=c.getContentPanel(),e=d.getLayout(),f=c.getNavigationTree(),g=f.getStore(),h=g.findNode("routeId",a)||g.findNode("viewType",a),i=h&&h.get("viewType")||"page404",j=c.lastView,k=d.child("component[routeId="+a+"]");if(h.get("split")&&(i=i.split("-")[0]),j&&j.isWindow&&j.destroy(),j=e.getActiveItem(),!k)if(h){var l=h.get("text"),m=h.get("iconCls"),n=h.get("description");b=a==c.loginViewType?Ext.create({xtype:c.loginViewType}):Ext.create({id:"main-panel-"+a,xtype:n?"panel":i,html:n||"",title:l,iconCls:m,routeId:a,hideMode:"offsets"})}else b=Ext.create({xtype:i,routeId:a,hideMode:"offsets"});b&&b.isWindow||(k?(k!==j&&e.setActiveItem(k),b=k):(Ext.suspendLayouts(),e.setActiveItem(d.add(b)),Ext.resumeLayouts(!0))),h&&(h.isRoot()?f.ensureVisible(0,{focus:!0}):(h.parentNode&&!h.parentNode.isExpanded()&&h.parentNode.expand(),f.ensureVisible(h,{focus:!0,select:!0}))),b.isFocusable(!0)&&b.focus(),c.lastView=b},onRouteChange:function(a){this.setCurrentView(a)},onNavigationTreeSelectionChange:function(a,b,c,d,e,f){console.log("setup2.");var g=b&&(b.get("routeId")||b.get("viewType"));g&&this.redirectTo(g)},onContentPanelSubClose:function(a,b,c){if(2==a.items.getCount())this.redirectTo("");else{var d=a.items,e=d.length,f=d.getAt(e-2).routeId;this.redirectTo(f)}},positionedchange:function(a,b){this.redirectTo(b.routeId||"")}}),Ext.define("Admin.view.common.window.BaseWindow",{extend:"Ext.window.Window",xtype:"basewindow",layout:"fit",width:500,bodyPadding:5,modal:!0,closeAction:"hide",closeToolText:"关闭窗口",constrain:!0,constrainHeader:!0,maximizable:!0,resizable:!1}),Ext.define("Admin.view.common.window.BaseFormWindow",{extend:"Ext.window.Window",title:"新增",iconCls:"x-fa fa-floppy-o",width:400,layout:"fit",modal:!0,closeAction:"hide",closeToolText:"关闭窗口",constrain:!0,constrainHeader:!0,maximizable:!0,resizable:!1,border:!1,keyMap:{"CTRL+ENTER":"onSubmitBtnClicked",scope:"controller"},listeners:{beforeshow:function(){this.down("form").getForm().reset()}}}),Ext.define("Admin.view.common.panel.BaseGridPanel",{extend:"Ext.grid.Panel",viewConfig:{enableTextSelection:!0,emptyText:"<h3>No matching results</h3>"},selModel:{selType:"checkboxmodel"},bbar:{xtype:"pagingtoolbar",displayInfo:!0},columnLines:!0,loadMask:!0,initComponent:function(){this.callParent()}}),Ext.define("Admin.view.common.panel.BaseSearchPanel",{extend:"Ext.panel.Panel",layout:{type:"vbox",pack:"start",align:"begin"},bodyPadding:"5px",margin:"0 0 5px 0",defaults:{layout:{type:"hbox"},border:!1},subDefaults:{margin:"5px 5px",labelAlign:"left",labelWidth:60},keyMap:{ENTER:"onSearchPanelQuery",scope:"controller"}}),Ext.define("Admin.view.common.charts.BaseChart",{extend:"Ext.Panel",height:580,layout:"fit",bodyPadding:5,platformConfig:{classic:{headerPosition:"top"},modern:{header:{docked:"top"}}},collapsible:!0,titleCollapse:!0}),Ext.define("Admin.view.main.MainController",{extend:"Ext.app.ViewController",alias:"controller.main",onMainViewRender:function(){var a=Ext.Object.fromQueryString(location.search),b=(a.ref,a.module||"");this.redirectTo(b)}}),Ext.define("Admin.view.main.MainModel",{extend:"Ext.app.ViewModel",alias:"viewmodel.main",data:{ename:"hmlzs",cname:"老祖寺后台",adminUser:_am.currentUser.name,currentView:null}}),Ext.define("Admin.view.main.region.NavigationTree",{extend:"Ext.tree.Panel",xtype:"navigation-tree",id:"navigation-tree",title:"菜单",iconCls:"x-fa fa-bars",rootVisible:!1,lines:!1,useArrows:!0,width:250,height:200,stateful:!0,stateId:"mainnav.west",collapsible:!0,titleCollapse:!0,enableColumnResize:!1,enableColumnMove:!1,store:"navigation"}),Ext.define("Admin.view.main.region.ContentTabPanel",{extend:"Ext.tab.Panel",xtype:"contentPanel",id:"content-tabpanel",viewModel:{type:"main"},header:{hidden:!0},defaults:{closable:!0,closeAction:"destory"},plugins:Ext.create("Ext.ux.TabCloseMenu"),items:{title:"工作台",id:"workbench",iconCls:"x-fa fa-home",closable:!1,scrollable:"y",xtype:"workbench"}}),Ext.define("Admin.view.main.Main",{extend:"Ext.panel.Panel",plugins:["viewport"],requires:[],controller:"main",viewModel:"main",layout:"border",border:!1,icon:"http://www.pconline.com.cn/favicon.ico",initComponent:function(){var a=this;Ext.apply(a,{header:{baseCls:"x-panel-body",border:!1,height:60,items:[{xtype:"image",src:"http://www.hmlzs.cn/static/lzs/images/logo.png",userCls:"admin-header-logo"},{xtype:"tbtext",userCls:"x-fa fa-user",bind:{text:"{adminUser}，欢迎您！"}},{xtype:"tbtext",userCls:"x-fa fa-sign-out",html:' <a href="logout">退出</a>'}]},items:[{region:"west",xtype:"navigation-tree",split:!0},{region:"center",xtype:"contentPanel"}]}),a.callParent()}}),Ext.define("Admin.controller.ViewController",{extend:"Ext.app.ViewController",config:{searchPrefix:"search-",searchGridSuffix:"-mgrid"},getContentPanel:function(){return Admin.app.getController("AppController").getContentPanel()},onSearchPanelQuery:function(){var a=this,b=a.getView(),c=a.getSearchPrefix(),d=a.getSearchGridSuffix(),e=b.query("[itemId^="+c+"]"),f=b.down(b.xtype+d),g=f.getStore(),h=[];Ext.each(e,function(a,b,d){var e=a.itemId.slice(c.length),f=a.getValue();f&&"string"==typeof f&&(f=f.indexOf("全部")>-1?"":f),h.push({property:e,value:f})}),g.setFilters(h)},onSearchPanelReset:function(){var a=this,b=a.getView(),c=a.getSearchPrefix(),d=a.getSearchGridSuffix(),e=b.query("[itemId^="+c+"]"),f=b.down(b.xtype+d),g=f.getStore();Ext.each(e,function(a,b,c){a.setValue("")}),g.clearFilter()},formSubmit:function(a,b,c){var d=Ext.apply({submitEmptyText:!1,url:"",waitMsgTarget:!0,waitTitle:"请稍候...",success:c,failure:Ext.ux.formFailure},b);a.submit(d)},sendAjaxFromIds:function(a,b,c,d){if(!a)return void Ext.log("缺少action");var e=[];if(Ext.each(c.getSelection(),function(a,b,c){0!==a.id&&e.push(a.id)}),0!=e.length){var f=Ext.apply({url:"",params:{method:a,ids:e},success:function(a,d){var e=Ext.decode(a.responseText),f=e.success;e.msg;f?Ext.ux.Msg.info(b+"成功",function(){c.getStore().reload(),c.getSelectionModel().deselectAll()}):Ext.ux.Msg.ajaxFailure(a,d)},failure:Ext.ux.Msg.ajaxFailure},d);Ext.MessageBox.confirm("提示","共选中【"+e.length+"】项，确定要【"+b+"】吗？",function(a){"no"!==a&&Ext.Ajax.request(f)})}},sendAjaxFromData:function(a,b,c,d){if(!a)return void Ext.log("缺少action");var e=[];if(Ext.each(c.getSelection(),function(a,b,c){a.dirty&&e.push(a.data)}),0!=e.length){var f=Ext.apply({url:"",params:{method:a,data:Ext.util.JSON.encode(e)},success:function(a,d){var e=Ext.decode(a.responseText),f=e.success;e.msg;f?Ext.ux.Msg.info(b+"成功",function(){c.getStore().reload(),c.getSelectionModel().deselectAll()}):Ext.ux.Msg.ajaxFailure(a,d)},failure:Ext.ux.Msg.ajaxFailure},d);Ext.MessageBox.confirm("提示","共选中【"+e.length+"】项，确定要【"+b+"】吗？",function(a){"no"!==a&&Ext.Ajax.request(f)})}},onRefreshBtnClicked:function(a){var b=a.up("grid"),c=a.up("grid").getStore();c.getProxy().setExtraParam("page",1),c.reload(),b.getSelectionModel().deselectAll()},onResetBtnClicked:function(a){this.getView().down("form").reset()},onBtnClicked:function(a){Ext.log(a.text)}}),Ext.define("Admin.view.workbench.WorkbenchController",{extend:"Admin.controller.ViewController",alias:"controller.workbench",module:"workbench",url:"Super Awesome",init:function(){console.log(this)},control:{"workbench-sp button[action=search]":{click:"onSearchPanelQuery"},"workbench-sp button[action=reset]":{click:"onSearchPanelReset"},"workbench-mgrid":{selectionchange:"onSelectionChange"},"workbench-mgrid button[action=audit]":{click:"onBtnClicked"},"workbench-mgrid button[action=rework]":{click:"onBtnClicked"},"workbench-mgrid button[action=move]":{click:"onBtnClicked"},"workbench-mgrid button[action=delete]":{click:"onBtnClicked"},"workbench-mgrid button[action=release]":{click:"onBtnClicked"},"workbench-mgrid button[action=refresh]":{click:"onRefreshBtnClicked"}},onSelectionChange:function(a,b,c){var d=this,e=d.getView(),f=(d.getViewModel(),d.module),g=e.down(f+d.getSearchGridSuffix()),h=b?b.length:0;0==h&&Ext.log("No selection"),g.down("button[action=audit]").setDisabled(h<1),g.down("button[action=rework]").setDisabled(h<1),g.down("button[action=move]").setDisabled(h<1),g.down("button[action=delete]").setDisabled(h<1),g.down("button[action=release]").setDisabled(h<1)},onBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromIds(a.action,a.text,c,{url:"data/ajax.json?"+a.action})}}),Ext.define("Admin.view.workbench.WorkbenchSearchPanel",{extend:"Admin.view.common.panel.BaseSearchPanel",xtype:"workbench-sp",initComponent:function(){var a=this,b=a.subDefaults;Ext.apply(a,{items:[{defaults:b,items:[{xtype:"textfield",fieldLabel:"文章ID",emptyText:"如：100015",itemId:"search-id"},{xtype:"textfield",fieldLabel:"文章标题",emptyText:"",itemId:"search-title"},{xtype:"datefield",fieldLabel:"开始日期",itemId:"search-startdate",vtype:"daterange",endDateField:"search-enddate",editable:!1,format:"Y-m-d",submitFormat:"Y-m-d"},{xtype:"datefield",fieldLabel:"结束日期",itemId:"search-enddate",vtype:"daterange",editable:!1,startDateField:"search-startdate",format:"Y-m-d",submitFormat:"Y-m-d"},{xtype:"button",text:"查询",iconCls:"x-fa fa-search",action:"search"},{xtype:"button",text:"重置",iconCls:"x-fa fa-undo",action:"reset"}]}]}),a.callParent()}}),Ext.define("Admin.view.workbench.WorkbenchMainGrid",{extend:"Admin.view.common.panel.BaseGridPanel",xtype:"workbench-mgrid",initComponent:function(){var a=this;Ext.apply(a,{store:Ext.create("Ext.data.Store",{proxy:{type:"ajax",url:"data/workbenchs.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0}),columns:[{text:"ID",dataIndex:"id",width:80},{text:"状态",dataIndex:"status",renderer:a.renderer,width:80},{text:"标题",dataIndex:"title",renderer:a.renderer,flex:1},{text:"栏目",dataIndex:"category",width:150},{text:"作者",dataIndex:"author"},{text:"创建人",dataIndex:"creator"},{text:"创建时间",dataIndex:"createDate",xtype:"datecolumn",format:"y-m-d H:i:s",width:150},{text:"更新时间",dataIndex:"lastChange",xtype:"datecolumn",format:"y-m-d H:i:s",width:150}],tbar:[{xtype:"button",text:"审核",iconCls:"x-fa fa-check-circle-o",disabled:!0,action:"audit"},{xtype:"button",text:"返工",iconCls:"x-fa fa-undo",disabled:!0,action:"rework"},{xtype:"button",text:"移动",iconCls:"x-fa fa-exchange",disabled:!0,action:"move"},{xtype:"button",text:"删除",iconCls:"x-fa fa-trash-o",disabled:!0,action:"delete"},{xtype:"button",text:"发布",iconCls:"x-fa fa-paper-plane-o",disabled:!0,action:"release"},"-",{xtype:"button",text:"刷新",iconCls:"x-fa fa-refresh",action:"refresh"},"->",{xtype:"label",tpl:"共 <strong>{article}</strong> 篇文章，<strong>{picture}</strong> 张图片，<strong>{voice}</strong> 条音频， 感恩您的努力！",style:{color:"crimson"},listeners:{beforerender:function(a,b){Ext.Ajax.request({url:"data/fileinfo.json"}).then(function(b,c){var d=Ext.decode(b.responseText);a.setHtml(d)},function(a,b){Ext.log("server-side failure with status code "+a.status)})}}}]}),a.callParent()},renderer:function(a,b,c,d,e,f,g){switch(this.getHeaderContainer().getHeaderAtIndex(e).dataIndex){case"status":switch(a){case 0:return b.tdStyle="color:#0066FF","初稿";case 1:return b.tdStyle="color:blank","已签";case 5:return b.tdStyle="color:#FF6633","返工";case 9:return b.tdStyle="color:blank","已发";case 10:return b.tdStyle="color:red","已删"}case"title":default:return a}}}),Ext.define("Admin.view.workbench.Workbench",{extend:"Ext.panel.Panel",xtype:"workbench",requires:[],controller:"workbench",layout:"border",margin:5,initComponent:function(){var a=this;Ext.apply(a,{items:[{region:"north",xtype:"workbench-sp"},{region:"center",xtype:"workbench-mgrid"},{region:"south",xtype:"homepage"}]}),a.callParent()}}),Ext.define("Admin.view.content.ContentController",{extend:"Admin.controller.ViewController",alias:"controller.content",module:"content",url:"Super Awesome",init:function(){console.log(this)},control:{"content-sp button[action=search]":{click:"onSearchPanelQuery"},"content-sp button[action=reset]":{click:"onSearchPanelReset"},"content-mgrid":{selectionchange:"onSelectionChange",itemclick:"onItemClick"},"content-mgrid button[action=add]":{click:"onAddBtnClicked"},"content-mgrid button[action=audit]":{click:"onBtnClicked"},"content-mgrid button[action=rework]":{click:"onBtnClicked"},"content-mgrid button[action=move]":{click:"onBtnClicked"},"content-mgrid button[action=delete]":{click:"onBtnClicked"},"content-mgrid button[action=release]":{click:"onBtnClicked"},"content-mgrid button[action=refresh]":{click:"onRefreshBtnClicked"},"content-mgrid button[action=content-headline-text]":{click:"onTextHeadLineBtnClicked"},"content-mgrid button[action=content-headline-picture]":{click:"onPictureHeadLineBtnClicked"}},onSelectionChange:function(a,b,c){var d=this,e=d.getView(),f=(d.getViewModel(),e.down("content"+d.getSearchGridSuffix())),g=b?b.length:0;0==g&&Ext.log("No selection"),f.down("button[action=audit]").setDisabled(g<1),f.down("button[action=rework]").setDisabled(g<1),f.down("button[action=move]").setDisabled(g<1),f.down("button[action=delete]").setDisabled(g<1),f.down("button[action=release]").setDisabled(g<1)},onItemClick:function(a,b,c,d,e,f){var g=this,h=g.getView(),i=e.target;if(i){var j=i.getAttribute("action"),k=h.id.split("-"),k=k[k.length];switch(j){case"set-text-headline":var l="content-headline-text-mform-"+k,m=g.lookupReference(l);m||(m=Ext.create({xtype:"content-headline-text-mform",reference:l}),h.add(m)),m.setTitle("新增文字头条"),m.show(),m.down("form").getForm().loadRecord(b);break;case"set-picture-headline":var l="content-headline-picture-mform-"+k,m=g.lookupReference(l);m||(m=Ext.create({xtype:"content-headline-picture-mform",reference:l}),h.add(m)),m.setTitle("新增图片头条"),m.show(),m.down("form").getForm().loadRecord(b)}}},onAddBtnClicked:function(a){var b=this,c=b.getView(),d=c.id.split("-"),d=d[d.length],e="content-mform-"+d,f=b.lookupReference(e);f||(f=Ext.create({xtype:"content-mform",reference:e}),c.add(f)),f.setTitle("【"+c.getTitle()+"】新增文章"),f.show()},onBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromIds(a.action,a.text,c,{url:"data/ajax.json?"+a.action})},onTextHeadLineBtnClicked:function(a){var b=this,c=b.getView(),d=c.id.split("-"),d=d[d.length],e="content-headline-text-win-"+d,f=b.lookupReference(e);f||(f=Ext.create({xtype:"headlinewindow",reference:e,viewModel:{data:{category:d,categoryName:c.getTitle(),subItem:"content-headline-text-mgrid",type:"text"}}}),c.add(f)),f.show()},onPictureHeadLineBtnClicked:function(a){var b=this,c=b.getView(),d=c.id.split("-"),d=d[d.length],e="content-headline-picture-win-"+d,f=b.lookupReference(e);f||(f=Ext.create({xtype:"headlinewindow",reference:e,viewModel:{data:{category:d,categoryName:c.getTitle(),subItem:"content-headline-picture-mgrid",type:"picture"}}}),c.add(f)),f.show()}}),Ext.define("Admin.view.content.ContentSearchPanel",{extend:"Admin.view.common.panel.BaseSearchPanel",xtype:"content-sp",initComponent:function(){var a=this,b=a.subDefaults;Ext.apply(a,{items:[{defaults:b,items:[{xtype:"textfield",fieldLabel:"文章ID",emptyText:"如：100015",itemId:"search-id"},{xtype:"textfield",fieldLabel:"文章标题",emptyText:"",itemId:"search-title"},{xtype:"datefield",fieldLabel:"开始日期",itemId:"search-startdate",vtype:"daterange",endDateField:"search-enddate",editable:!1,format:"Y-m-d",submitFormat:"Y-m-d"},{xtype:"datefield",fieldLabel:"结束日期",itemId:"search-enddate",vtype:"daterange",editable:!1,startDateField:"search-startdate",format:"Y-m-d",submitFormat:"Y-m-d"},{xtype:"button",text:"查询",iconCls:"x-fa fa-search",action:"search"},{xtype:"button",text:"重置",iconCls:"x-fa fa-undo",action:"reset"}]}]}),a.callParent()}}),Ext.define("Admin.view.content.ContentMainGrid",{extend:"Admin.view.common.panel.BaseGridPanel",xtype:"content-mgrid",actions:{preview:{iconCls:"x-fa fa-file-excel-o c-forestgreen",tooltip:"预览",handler:"onDownloadFileBtnClick"},add:{iconCls:"x-fa fa-file-excel-o c-forestgreen",tooltip:"新增子栏目",handler:"onDownloadFileBtnClick"},article:{iconCls:"x-fa fa-building",tooltip:"文章列表",handler:"onCreateOrderBtnClicked"},headline:{iconCls:"x-fa fa-search-plus",tooltip:"头条列表",handler:"onSearchOrderBtnClicked"},picture:{iconCls:"x-fa fa-calendar",tooltip:"图片列表",handler:"onAdInfoBtnClicked"}},initComponent:function(){var a=this;Ext.apply(a,{store:Ext.create("Ext.data.Store",{proxy:{type:"ajax",url:"data/news.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0}),columns:[{text:"ID",dataIndex:"id",width:80},{text:"状态",dataIndex:"status",renderer:a.renderer,width:80},{text:"标题",dataIndex:"title",renderer:a.renderer,flex:1},{text:"栏目",dataIndex:"category",width:150},{text:"作者",dataIndex:"author"},{text:"创建人",dataIndex:"creator"},{text:"头条",dataIndex:"headlineArticle",renderer:a.renderer},{text:"图片",dataIndex:"headlinePic",renderer:a.renderer},{text:"创建时间",dataIndex:"createDate",xtype:"datecolumn",format:"y-m-d H:i:s",width:150},{text:"更新时间",dataIndex:"lastChange",xtype:"datecolumn",format:"y-m-d H:i:s",width:150}],tbar:[{xtype:"button",text:"新增",iconCls:"x-fa fa-plus-circle",action:"add"},{xtype:"button",text:"审核",iconCls:"x-fa fa-check-circle-o",disabled:!0,action:"audit"},{xtype:"button",text:"返工",iconCls:"x-fa fa-undo",disabled:!0,action:"rework"},{xtype:"button",text:"移动",iconCls:"x-fa fa-exchange",disabled:!0,action:"move"},{xtype:"button",text:"删除",iconCls:"x-fa fa-trash-o",disabled:!0,action:"delete"},{xtype:"button",text:"发布",iconCls:"x-fa fa-paper-plane-o",disabled:!0,action:"release"},"-",{xtype:"button",text:"刷新",iconCls:"x-fa fa-refresh",action:"refresh"},"->",{xtype:"button",text:"栏目头条列表",userCls:"admin-label-button",action:"content-headline-text"},{xtype:"button",text:"栏目图片列表",userCls:"admin-label-button",action:"content-headline-picture"},{xtype:"button",text:"栏目预览",userCls:"admin-label-button",action:"preview"}]}),a.callParent()},renderer:function(a,b,c,d,e,f,g){switch(this.getHeaderContainer().getHeaderAtIndex(e).dataIndex){case"status":switch(a){case 0:return b.tdStyle="color:#0066FF","初稿";case 1:return b.tdStyle="color:blank","已签";case 5:return b.tdStyle="color:#FF6633","返工";case 9:return b.tdStyle="color:blank","已发";case 10:return b.tdStyle="color:red","已删"}case"headlineArticle":switch(a){case 1:return'<button class="x-fa fa-flag admin-label-button admin-color-purple" action="set-text-headline"></button>';case 0:return'<button class="x-fa fa-flag admin-label-button admin-color-gray" action="cancel-text-headline"></button>'}case"headlinePic":switch(a){case 2:return'<button class="x-fa fa-picture-o admin-label-button admin-color-purple" action="set-picture-headline"></button>';case 0:return'<button class="x-fa fa-picture-o admin-label-button admin-color-gray" action="cancel-picture-headline"></button>'}default:return a}}}),Ext.define("Admin.view.content.ContentMainForm",{extend:"Admin.view.common.window.BaseFormWindow",xtype:"content-mform",controller:"content",maximized:!0,maximizable:!1,initComponent:function(){var a=this,b=Ext.create({xtype:"form",layout:"anchor",bodyPadding:10,defaults:{anchor:"100%",labelAlign:"right",msgTarget:"side",beforeLabelTextTpl:'<span class="admin-color-red">* </span>'},defaultType:"textfield",items:[{fieldLabel:"newsId",hidden:!0},{xtype:"fieldcontainer",fieldLabel:"文章标题",layout:"hbox",combineErrors:!0,defaultType:"textfield",items:{name:"name",allowBlank:!1,width:"50%"}},{xtype:"fieldcontainer",fieldLabel:"文章来源",layout:"hbox",combineErrors:!0,defaultType:"textfield",items:{name:"name",allowBlank:!1,width:"50%"}},{xtype:"fieldcontainer",fieldLabel:"作者",layout:"hbox",combineErrors:!0,defaultType:"textfield",items:{name:"name",allowBlank:!1,width:"50%"}},{xtype:"fieldcontainer",fieldLabel:"描述",layout:"hbox",combineErrors:!0,defaultType:"textarea",items:[{name:"name",allowBlank:!1,minLength:50,maxLength:200,width:"50%"},{xtype:"tbtext",userCls:"x-fa fa-info-circle",text:" 50~200个字"}]},{xtype:"fieldcontainer",fieldLabel:"标签",layout:"hbox",combineErrors:!0,defaultType:"textfield",items:[{xtype:"tagfield",name:"name",store:{proxy:{type:"ajax",url:"data/keywords.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0},displayField:"name",valueField:"id",queryMode:"local",createNewOnEnter:!0,createNewOnBlur:!0,filterPickList:!0,allowBlank:!1,width:"50%"},{xtype:"tbtext",userCls:"x-fa fa-info-circle",text:"多选，可手动输入（回车或切换焦点即可创建），也可从标签库选择"}]},{xtype:"fieldcontainer",beforeLabelTextTpl:"",fieldLabel:"连载",layout:"hbox",combineErrors:!0,defaultType:"textfield",items:{xtype:"combobox",name:"",store:{proxy:{type:"ajax",url:"data/serals.json",reader:{type:"json",rootProperty:"rows"}}},displayField:"title",valueField:"id",queryMode:"remote",minChars:1,triggerAction:"all",typeAhead:!0,forceSelection:!0,emptyText:"请选择系列",allowBlank:!1,width:"50%"}},{xtype:"textarea",itemId:"content-area",name:"desc",beforeLabelTextTpl:"",width:"100%",height:460,listeners:{afterrender:function(a,b){editor=KindEditor.create("#"+a.id,{resizeType:1,allowPreviewEmoticons:!1,items:["fontname","fontsize","|","forecolor","hilitecolor","bold","italic","underline","removeformat","|","justifyleft","justifycenter","justifyright","insertorderedlist","insertunorderedlist","|","table","emoticons","image","link","|","quickformat","pagebreak","fullscreen"],allowFileUpload:!1,uploadJson:"media/create",fillDescAfterUploadImage:!0,formatUploadUrl:!1,extraFileUploadParams:{type:1}})}}}],buttons:[{text:"预览",iconCls:"x-fa fa-eye",action:"preview",handler:"onPreviewBtnClicked"},{text:"提交",iconCls:"x-fa fa-floppy-o",tooltip:"快捷键：Ctrl+Enter",disabled:!0,formBind:!0,action:"submit",handler:"onSubmitBtnClicked"}]});Ext.apply(a,{items:b}),a.callParent()}}),Ext.define("Admin.view.content.headline.HeadLineWindow",{extend:"Admin.view.common.window.BaseWindow",xtype:"headlinewindow",maximizable:!1,maximized:!0,border:!1,initComponent:function(){var a=this,b=a.getViewModel(),c=b.get("category"),d=b.get("categoryName"),e=b.get("type"),f=b.get("subItem");switch(e){case"text":a.setTitle("【"+d+"】栏目文字列表");break;case"picture":a.setTitle("【"+d+"】图片头条列表")}Ext.apply(a,{items:{xtype:f,viewModel:{data:c}}}),a.callParent()}}),Ext.define("Admin.view.content.headline.text.TextController",{extend:"Admin.controller.ViewController",alias:"controller.content-headline-text",module:"content-headline-text",url:"Super Awesome",init:function(){console.log(this)},control:{"content-headline-text-mgrid":{selectionchange:"onSelectionChange"},"content-headline-text-mgrid button[action=save]":{click:"onSaveBtnClicked"},"content-headline-text-mgrid button[action=delete]":{click:"onBtnClicked"},"content-headline-text-mgrid button[action=refresh]":{click:"onRefreshBtnClicked"},"content-headline-text-mgrid button[action=content-headline-picture]":{click:"onPictureHeadLineBtnClicked"}},onSelectionChange:function(a,b,c){var d=this,e=d.getView(),f=(d.getViewModel(),d.module,b?b.length:0);0==f&&Ext.log("No selection"),e.down("button[action=save]").setDisabled(f<1),e.down("button[action=delete]").setDisabled(f<1)},onSaveBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromData(a.action,a.text,c,{url:"data/ajax.json?"+a.action})},onBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromIds(a.action,a.text,c,{url:"data/ajax.json?"+a.action})},onPictureHeadLineBtnClicked:function(a){var b=this,c=b.getView(),d=c.up().up(),e=d.getController(),f=d.id.split("-"),f=f[f.length],g="content-headline-picture-win-"+f;c.up().hide();var h=e.lookupReference(g);h||(h=Ext.create({xtype:"headlinewindow",reference:g,viewModel:{data:{category:f,categoryName:d.getTitle(),subItem:"content-headline-picture-mgrid",type:"picture"}}}),d.add(h)),h.show()},onSubmitBtnClicked:function(a){var b=this,c=b.getView(),d=c.up(),e=c.down("form").getForm();b.formSubmit(e,{url:"data/ajax.json"},function(a,b){Ext.ux.Msg.info("保存成功",function(){c.hide();var a=d.down("grid");a.getStore().reload(),a.getSelectionModel().deselectAll()})})}}),Ext.define("Admin.view.content.headline.text.TextMainGrid",{extend:"Admin.view.common.panel.BaseGridPanel",xtype:"content-headline-text-mgrid",requires:[],controller:"content-headline-text",initComponent:function(){var a=this,b=a.getViewModel();Ext.apply(a,{store:Ext.create("Ext.data.Store",{proxy:{type:"ajax",url:"data/texts.json",extraParams:{category:b.get("category")||""},reader:{type:"json",rootProperty:"rows"}},autoLoad:!0}),columns:[{text:"ID",dataIndex:"id",width:80},{text:'次序 <span class="admin-color-red">+</span>',dataIndex:"rank",editor:{xtype:"numberfield",allowBlank:!1,allowDecimals:!1,minValue:0},width:80},{text:"状态",dataIndex:"status",renderer:a.renderer,width:80},{text:"标题",dataIndex:"title",renderer:a.renderer,flex:1},{text:"栏目",dataIndex:"category",width:150},{text:'套红 <span class="admin-color-red">+</span>',dataIndex:"redStatus",xtype:"checkcolumn"},{text:"创建人",dataIndex:"creator"},{text:"加入时间",dataIndex:"createDate",xtype:"datecolumn",format:"y-m-d H:i:s",width:150},{text:"更新时间",dataIndex:"lastChange",xtype:"datecolumn",format:"y-m-d H:i:s",width:150}],tbar:[{xtype:"button",text:"保存",iconCls:"x-fa fa-floppy-o",disabled:!0,action:"save"},{xtype:"button",text:"删除",iconCls:"x-fa fa-trash-o",disabled:!0,action:"delete"},"-",{xtype:"button",text:"刷新",iconCls:"x-fa fa-refresh",action:"refresh"},"->",{xtype:"button",text:"栏目图片列表",userCls:"admin-label-button",action:"content-headline-picture"}],plugins:[{ptype:"cellediting",clicksToEdit:2}]}),a.callParent()},renderer:function(a,b,c,d,e,f,g){switch(this.getHeaderContainer().getHeaderAtIndex(e).dataIndex){case"status":switch(a){case 0:return b.tdStyle="color:#0066FF","初稿";case 1:return b.tdStyle="color:blank","已签";case 5:return b.tdStyle="color:#FF6633","返工";case 9:return b.tdStyle="color:blank","已发";case 10:return b.tdStyle="color:red","已删"}case"title":return 1==c.get("redStatus")?'<span class="admin-color-red">'+a+"</span>":a;case"headlinePic":switch(a){case 2:return'<span class="x-fa fa-picture"></span>';case 0:return'<span class="x-fa fa-picture-o"></span>'}default:return a}}}),Ext.define("Admin.view.content.headline.picture.PictureController",{extend:"Admin.controller.ViewController",alias:"controller.content-headline-picture",module:"content-headline-picture",url:"Super Awesome",init:function(){console.log(this)},control:{"content-headline-picture-mgrid":{selectionchange:"onSelectionChange"},"content-headline-picture-mgrid button[action=save]":{click:"onSaveBtnClicked"},"content-headline-picture-mgrid button[action=delete]":{click:"onBtnClicked"},"content-headline-picture-mgrid button[action=refresh]":{click:"onRefreshBtnClicked"},"content-headline-picture-mgrid button[action=content-headline-text]":{click:"onTextHeadLineBtnClicked"}},onSelectionChange:function(a,b,c){var d=this,e=d.getView(),f=(d.getViewModel(),d.module,b?b.length:0);0==f&&Ext.log("No selection"),e.down("button[action=save]").setDisabled(f<1),e.down("button[action=delete]").setDisabled(f<1)},onSaveBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromData(a.action,a.text,c,{url:"data/ajax.json?"+a.action})},onBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromIds(a.action,a.text,c,{url:"data/ajax.json?"+a.action})},onTextHeadLineBtnClicked:function(a){var b=this,c=b.getView(),d=c.up().up(),e=d.getController(),f=d.id.split("-"),f=f[f.length],g="content-headline-text-win-"+f;c.up().hide();var h=e.lookupReference(g);h||(h=Ext.create({xtype:"headlinewindow",reference:g,viewModel:{data:{category:f,categoryName:d.getTitle(),subItem:"content-headline-text-mgrid",type:"text"}}}),d.add(h)),h.show()}}),Ext.define("Admin.view.content.headline.picture.PictureMainGrid",{extend:"Admin.view.common.panel.BaseGridPanel",xtype:"content-headline-picture-mgrid",requires:[],controller:"content-headline-picture",initComponent:function(){var a=this,b=a.getViewModel();Ext.apply(a,{store:Ext.create("Ext.data.Store",{proxy:{type:"ajax",url:"data/texts.json",extraParams:{category:b.get("category")||""},reader:{type:"json",rootProperty:"rows"}},autoLoad:!0}),columns:[{text:"ID",dataIndex:"id",width:80},{text:'次序 <span class="admin-color-red">+</span>',dataIndex:"rank",editor:{xtype:"numberfield",allowBlank:!1,allowDecimals:!1,minValue:0},width:80},{text:"状态",dataIndex:"status",renderer:a.renderer,width:80},{text:"标题",dataIndex:"title",renderer:a.renderer,flex:1},{text:"栏目",dataIndex:"category",width:150},{text:'套红 <span class="admin-color-red">+</span>',dataIndex:"redStatus",xtype:"checkcolumn"},{text:"创建人",dataIndex:"creator"},{text:"加入时间",dataIndex:"createDate",xtype:"datecolumn",format:"y-m-d H:i:s",width:150},{text:"更新时间",dataIndex:"lastChange",xtype:"datecolumn",format:"y-m-d H:i:s",width:150}],tbar:[{xtype:"button",text:"保存",iconCls:"x-fa fa-floppy-o",disabled:!0,action:"save"},{xtype:"button",text:"删除",iconCls:"x-fa fa-trash-o",disabled:!0,action:"delete"},"-",{xtype:"button",text:"刷新",iconCls:"x-fa fa-refresh",action:"refresh"},"->",{xtype:"button",text:"栏目头条列表",userCls:"admin-label-button",action:"content-headline-text"}]}),a.callParent()},renderer:function(a,b,c,d,e,f,g){switch(this.getHeaderContainer().getHeaderAtIndex(e).dataIndex){case"status":switch(a){case 0:return b.tdStyle="color:#0066FF","初稿";case 1:return b.tdStyle="color:blank","已签";case 5:return b.tdStyle="color:#FF6633","返工";case 9:return b.tdStyle="color:blank","已发";case 10:return b.tdStyle="color:red","已删"}case"title":return 1==c.get("redStatus")?'<span class="admin-color-red">'+a+"</span>":a;default:return a}}}),Ext.define("Admin.view.content.headline.picture.PictureMainForm",{extend:"Admin.view.common.window.BaseFormWindow",xtype:"content-headline-picture-mform",requires:[],controller:"content-headline-picture",maximized:!0,minWidth:800,initComponent:function(){var a=this;Ext.apply(a,{items:{xtype:"panel",layout:{type:"vbox",pack:"start",align:"stretch"},items:[{flex:2,region:"center",items:{xtype:"form",scrollable:!0,style:{marginBottom:10},items:{xtype:"fieldcontainer",layout:"anchor",defaults:{xtype:"fieldcontainer",layout:{type:"hbox",pack:"start",align:"stretch"},margin:"5 0 5 10",defaults:{anchor:"100%",labelWidth:80,labelAlign:"right",msgTarget:"side",beforeLabelTextTpl:'<span class="admin-color-red">* </span>',width:600},defaultType:"textfield"},items:[{items:[{xtype:"displayfield",reference:"title",publishes:"value",fieldLabel:"文章标题",name:"title"},{xtype:"displayfield",fieldLabel:"文章ID",name:"id",width:100}]},{items:[{fieldLabel:"头条标题",name:"topTitle",bind:{value:"{title.value}"},allowBlank:!1}]},{layout:{type:"vbox"},items:[{xtype:"filefield",fieldLabel:"标题图片",name:"photo",buttonText:"",buttonConfig:{iconCls:"x-fa fa-file-image-o"}},{xtype:"image",itemId:"form-image",beforeLabelTextTpl:"",src:"resources/images/placeholder.jpg",width:300,height:100,style:{left:"80px !important"}}]},{items:[{fieldLabel:"栏目名称",name:"category",allowBlank:!1}]},{items:{xtype:"itemselector",beforeLabelTextTpl:"",fieldLabel:"手工增加",name:"itemselector",maxHeight:200,scrollable:"y",imagePath:"../ux/images/",buttons:["add","remove"],buttonsText:["增加","删除"],store:{proxy:{type:"ajax",url:"data/categorys.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0},displayField:"name",valueField:"id",allowBlank:!1,msgTarget:"side"}}]},tbar:[{text:"重置",iconCls:"x-fa fa-undo",action:"reset",handler:"onResetBtnClicked"},{text:"提交",iconCls:"x-fa fa-floppy-o",tooltip:"快捷键：Ctrl+Enter",disabled:!0,formBind:!0,action:"submit",handler:"onSubmitBtnClicked"}]}},{region:"south",height:280,items:new Admin.view.keyword.KeywordMainGrid}]}}),a.callParent()}}),Ext.define("Admin.view.content.headline.text.TextMainForm",{extend:"Admin.view.common.window.BaseFormWindow",xtype:"content-headline-text-mform",requires:[],controller:"content-headline-text",maximized:!0,
width:1e3,height:800,layout:"border",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"panel",region:"center",layout:"fit",minHeight:400,scrollable:!0,items:[{xtype:"form",height:"100%",defaults:{defaults:{labelWidth:80,labelAlign:"right",width:"50%"}},bodyPadding:10,items:[{xtype:"fieldcontainer",fieldLabel:"",layout:{type:"hbox",align:"stretchmax"},items:[{xtype:"textfield",fieldLabel:"头条标题"},{xtype:"displayfield",width:"30%",fieldLabel:"文章ID",value:"1001"}]},{xtype:"fieldcontainer",fieldLabel:"",items:[{xtype:"displayfield",fieldLabel:"文章标题",value:"Display Field"}]},{xtype:"fieldcontainer",items:[{xtype:"filefield",fieldLabel:"标题图片"},{xtype:"container",height:150,width:"50%",fieldLabel:"",items:{xtype:"image",src:"resources/images/placeholder.jpg",height:150,width:300},style:{left:"80px"}}]},{xtype:"fieldcontainer",fieldLabel:"",items:[{xtype:"textfield",width:"50%",fieldLabel:"栏目名称"}]},{xtype:"fieldcontainer",layout:"fit",width:"60%",fieldLabel:"",items:[{xtype:"itemselector",width:"60%",height:137,imagePath:"../ux/images/",buttons:["add","remove"],buttonsText:["增加","删除"],store:{proxy:{type:"ajax",url:"data/categorys.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0},displayField:"name",valueField:"id",allowBlank:!1,msgTarget:"side"}]}]}]},{region:"south",height:150,items:new Admin.view.workbench.WorkbenchMainGrid}]}),a.callParent()}}),Ext.define("Admin.view.content.Content",{extend:"Ext.panel.Panel",xtype:"content",requires:[],uses:[],controller:"content",layout:"border",margin:5,initComponent:function(){var a=this;Ext.apply(a,{items:[{region:"north",xtype:"content-sp"},{region:"center",xtype:"content-mgrid"}]}),a.callParent()}}),Ext.define("Admin.view.content.recycle.RecycleController",{extend:"Admin.controller.ViewController",alias:"controller.content-recycle",module:"content-recycle",url:"Super Awesome",init:function(){console.log(this)},control:{"content-recycle-sp button[action=search]":{click:"onSearchPanelQuery"},"content-recycle-sp button[action=reset]":{click:"onSearchPanelReset"},"content-recycle-mgrid":{selectionchange:"onSelectionChange"},"content-recycle-mgrid button[action=restore]":{click:"onBtnClicked"},"content-recycle-mgrid button[action=refresh]":{click:"onRefreshBtnClicked"}},onSelectionChange:function(a,b,c){var d=this,e=d.getView(),f=(d.getViewModel(),d.module),g=e.down(f+d.getSearchGridSuffix()),h=d.lookupReference("status"),i=b?b.length:0;0==i&&(Ext.log("No selection"),h.update("")),h.update("已选中<strong>"+i+"</strong>篇文章！"),g.down("button[action=restore]").setDisabled(i<1)},onBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromIds(a.action,a.text,c,{url:"data/ajax.json?"+a.action})}}),Ext.define("Admin.view.content.recycle.RecycleSearchPanel",{extend:"Admin.view.common.panel.BaseSearchPanel",xtype:"content-recycle-sp",initComponent:function(){var a=this,b=a.subDefaults;Ext.apply(a,{items:[{defaults:b,items:[{xtype:"textfield",fieldLabel:"文章标题",emptyText:"",itemId:"search-title"},{xtype:"datefield",fieldLabel:"开始日期",itemId:"search-startdate",vtype:"daterange",endDateField:"search-enddate",editable:!1,format:"Y-m-d",submitFormat:"Y-m-d"},{xtype:"datefield",fieldLabel:"结束日期",itemId:"search-enddate",vtype:"daterange",editable:!1,startDateField:"search-startdate",format:"Y-m-d",submitFormat:"Y-m-d"},{xtype:"button",text:"查询",iconCls:"x-fa fa-search",action:"search"},{xtype:"button",text:"重置",iconCls:"x-fa fa-undo",action:"reset"}]}]}),a.callParent()}}),Ext.define("Admin.view.content.recycle.RecycleMainGrid",{extend:"Admin.view.common.panel.BaseGridPanel",xtype:"content-recycle-mgrid",initComponent:function(){var a=this;Ext.apply(a,{store:Ext.create("Ext.data.Store",{proxy:{type:"ajax",url:"data/news.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0}),columns:[{text:"ID",dataIndex:"id",width:80},{text:"状态",dataIndex:"status",renderer:a.renderer,width:80},{text:"标题",dataIndex:"title",renderer:a.renderer,flex:1},{text:"栏目",dataIndex:"category",width:150},{text:"作者",dataIndex:"author"},{text:"创建人",dataIndex:"creator"},{text:"头条",dataIndex:"headlineArticle",renderer:a.renderer},{text:"图片",dataIndex:"headlinePic",renderer:a.renderer},{text:"创建时间",dataIndex:"createDate",xtype:"datecolumn",format:"y-m-d H:i:s",width:150},{text:"更新时间",dataIndex:"lastChange",xtype:"datecolumn",format:"y-m-d H:i:s",width:150}],tbar:[{xtype:"button",text:"还原",iconCls:"x-fa fa-undo",disabled:!0,action:"restore"},"-",{xtype:"button",text:"刷新",iconCls:"x-fa fa-refresh",action:"refresh"},"-",{xtype:"component",reference:"status",style:{color:"crimson"}}]}),a.callParent()},renderer:function(a,b,c,d,e,f,g){switch(this.getHeaderContainer().getHeaderAtIndex(e).dataIndex){case"status":switch(a){case 0:return b.tdStyle="color:#0066FF","初稿";case 1:return b.tdStyle="color:blank","已签";case 5:return b.tdStyle="color:#FF6633","返工";case 9:return b.tdStyle="color:blank","已发";case 10:return b.tdStyle="color:red","已删"}case"headlineArticle":switch(a){case 1:return'<button class="x-fa fa-flag admin-label-button admin-color-purple" action="set-text-headline"></button>';case 0:return'<button class="x-fa fa-flag admin-label-button admin-color-gray" action="cancel-text-headline"></button>'}case"headlinePic":switch(a){case 2:return'<button class="x-fa fa-picture-o admin-label-button admin-color-purple" action="set-picture-headline"></button>';case 0:return'<button class="x-fa fa-picture-o admin-label-button admin-color-gray" action="cancel-picture-headline"></button>'}case"title":default:return a}}}),Ext.define("Admin.view.content.recycle.Recycle",{extend:"Ext.panel.Panel",xtype:"content-recycle",requires:[],controller:"content-recycle",layout:"border",margin:5,initComponent:function(){var a=this;Ext.apply(a,{items:[{region:"north",xtype:"content-recycle-sp"},{region:"center",xtype:"content-recycle-mgrid"}]}),a.callParent()}}),Ext.define("Admin.view.category.CategoryController",{extend:"Admin.controller.ViewController",alias:"controller.category",module:"category",url:"Super Awesome",init:function(){console.log(this)},control:{"category-mgrid":{selectionchange:"onSelectionChange",itemclick:"onItemClick"},"category-mgrid button[action=add]":{click:"onAddBtnClicked"},"category-mgrid button[action=save]":{click:"onSaveBtnClicked"},"category-mgrid button[action=delete]":{click:"onBtnClicked"},"category-mgrid button[action=refresh]":{click:"onRefreshBtnClicked"}},onSelectionChange:function(a,b,c){var d=this,e=d.getView(),f=(d.getViewModel(),d.module),g=e.down(f+d.getSearchGridSuffix()),h=b?b.length:0;0==h&&Ext.log("No selection"),g.down("button[action=save]").setDisabled(h<1),g.down("button[action=delete]").setDisabled(h<1)},onItemClick:function(a,b,c,d,e,f){var g=this,h=g.getView(),i=e.target;if(i){var j=i.getAttribute("action"),k=b.get("id");switch(j){case"preview":alert("【"+k+"】"+i.getAttribute("title"));break;case"add":var l=g.lookupReference("category-mform");l||(l=Ext.create({reference:"category-mform",xtype:"category-mform"}),h.add(l)),l.setTitle("新增子栏目"),l.show();var m=l.down("form").getForm();m.findField("parentId").setValue(k),m.findField("parentPath").setValue(b.get("name")).setHidden(!1);break;case"headlineText":case"picture":case"article":alert("【"+k+"】"+i.getAttribute("title"))}}},onAddBtnClicked:function(a){var b=this,c=b.getView(),d=b.lookupReference("category-mform");d||(d=Ext.create({reference:"category-mform",xtype:"category-mform"}),c.add(d)),d.setTitle("新增"),d.show();var e=d.down("form").getForm();e.findField("parentId").setValue(""),e.findField("parentPath").setValue("").setHidden(!0)},onSaveBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromData(a.action,a.text,c,{url:"data/ajax.json?"+a.action})},onBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromIds(a.action,a.text,c,{url:"data/ajax.json?"+a.action})},onSubmitBtnClicked:function(a){var b=this,c=b.getView(),d=c.down("form").getForm();b.formSubmit(d,{url:"data/ajax.json"},function(a,b){Ext.ux.Msg.info("保存成功",function(){c.hide();var a=c.up().down("category-mgrid"),b=a.getStore();b.getProxy().setExtraParam("page",1),b.reload(),a.getSelectionModel().deselectAll()})})}}),Ext.define("Admin.view.category.CategoryMainGrid",{extend:"Admin.view.common.panel.BaseGridPanel",xtype:"category-mgrid",actions:{preview:{iconCls:"x-fa fa-file-excel-o",tooltip:"预览",handler:"onDownloadFileBtnClick"},add:{iconCls:"x-fa fa-file-excel-o",tooltip:"新增子栏目",handler:"onDownloadFileBtnClick"},article:{iconCls:"x-fa fa-building",tooltip:"文章列表",handler:"onCreateOrderBtnClicked"},headline:{iconCls:"x-fa fa-search-plus",tooltip:"头条列表",handler:"onSearchOrderBtnClicked"},picture:{iconCls:"x-fa fa-calendar",tooltip:"图片列表",handler:"onAdInfoBtnClicked"}},initComponent:function(){var a=this;Ext.apply(a,{store:Ext.create("Ext.data.Store",{proxy:{type:"ajax",url:"data/categorys.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0}),columns:[{text:"栏目ID",dataIndex:"id",width:80},{text:'栏目名称 <span class="admin-color-red">+</span>',dataIndex:"name",width:250,editor:{xtype:"textfield",allowBlank:!1}},{text:"栏目路径",dataIndex:"path",width:250},{text:'存放路径 <span class="admin-color-red">+</span>',dataIndex:"eName",width:250,editor:{xtype:"textfield",allowBlank:!1}},{text:"栏目模板",dataIndex:"category_template",width:100},{text:"文章模板",dataIndex:"article_template",width:100},{text:"创建时间",dataIndex:"createDate",xtype:"datecolumn",format:"y-m-d H:i:s",width:150},{text:"操作",dataIndex:"id",renderer:a.renderer,width:200}],tbar:[{xtype:"button",text:"新增",iconCls:"x-fa fa-plus-circle",action:"add"},{xtype:"button",text:"保存",iconCls:"x-fa fa-floppy-o",disabled:!0,action:"save"},{xtype:"button",text:"删除",iconCls:"x-fa fa-trash-o",disabled:!0,action:"delete"},"-",{xtype:"button",text:"刷新",iconCls:"x-fa fa-refresh",action:"refresh"}],plugins:[{ptype:"cellediting",clicksToEdit:2}]}),a.callParent()},renderer:function(a,b,c,d,e,f,g){switch(this.getHeaderContainer().getHeaderAtIndex(e).dataIndex){case"id":return'<button class="admin-label-button" action="preview" title="预览栏目">预览</button><button class="admin-label-button" action="add" title="新增子栏目">新增</button><button class="admin-label-button" action="article" title="文章列表">文章</button><button class="admin-label-button" action="headlineText" title="栏目头条列表">头条</button><button class="admin-label-button" action="picture" title="栏目图片列表">图片</button>';default:return a}}}),Ext.define("Admin.view.category.CategoryMainForm",{extend:"Admin.view.common.window.BaseFormWindow",xtype:"category-mform",controller:"category",width:520,initComponent:function(){var a=this,b=Ext.create({xtype:"form",layout:"anchor",bodyPadding:10,defaults:{anchor:"100%",labelAlign:"right",msgTarget:"side",beforeLabelTextTpl:'<span class="admin-color-red">* </span>'},defaultType:"textfield",items:[{fieldLabel:"categoryId",hidden:!0},{fieldLabel:"parentId",name:"parentId",hidden:!0},{xtype:"displayfield",name:"parentPath",fieldLabel:"父路径",hidden:!0},{name:"name",fieldLabel:"目录名称",allowBlank:!1},{name:"ename",fieldLabel:"路径英文",allowBlank:!1},{xtype:"combobox",fieldLabel:"目录模板",name:"",store:{proxy:{type:"ajax",url:"data/categorys.json",reader:{type:"json",rootProperty:"rows"}}},displayField:"name",valueField:"id",queryMode:"remote",editable:!1,triggerAction:"all",forceSelection:!0,emptyText:"请选择",allowBlank:!1},{xtype:"combobox",fieldLabel:"文章模板",name:"",store:{proxy:{type:"ajax",url:"data/categorys.json",reader:{type:"json",rootProperty:"rows"}}},displayField:"name",valueField:"id",queryMode:"remote",editable:!1,triggerAction:"all",forceSelection:!0,emptyText:"请选择",allowBlank:!1},{xtype:"textarea",name:"desc",beforeLabelTextTpl:"",fieldLabel:"目录描述"},{xtype:"textarea",name:"counter",beforeLabelTextTpl:"",fieldLabel:"计数器"}],buttons:[{text:"重置",iconCls:"x-fa fa-undo",action:"reset",handler:"onResetBtnClicked"},{text:"提交",iconCls:"x-fa fa-floppy-o",tooltip:"快捷键：Ctrl+Enter",disabled:!0,formBind:!0,action:"submit",handler:"onSubmitBtnClicked"}]});Ext.apply(a,{items:b}),a.callParent()}}),Ext.define("Admin.view.category.Category",{extend:"Ext.panel.Panel",xtype:"category",requires:[],uses:[],controller:"category",layout:"border",margin:5,initComponent:function(){var a=this;Ext.apply(a,{items:[{region:"center",xtype:"category-mgrid"}]}),a.callParent()}}),Ext.define("Admin.view.template.TemplateController",{extend:"Admin.controller.ViewController",alias:"controller.template",module:"template",url:"Super Awesome",init:function(){console.log(this)},control:{"template-mgrid":{selectionchange:"onSelectionChange"},"template-mgrid button[action=add]":{click:"onAddBtnClicked"},"template-mgrid button[action=save]":{click:"onSaveBtnClicked"},"template-mgrid button[action=delete]":{click:"onBtnClicked"},"template-mgrid button[action=refresh]":{click:"onRefreshBtnClicked"}},onSelectionChange:function(a,b,c){var d=this,e=d.getView(),f=(d.getViewModel(),d.module),g=e.down(f+d.getSearchGridSuffix()),h=b?b.length:0;0==h&&Ext.log("No selection"),g.down("button[action=save]").setDisabled(h<1),g.down("button[action=delete]").setDisabled(h<1)},onAddBtnClicked:function(a){var b=this,c=b.getView(),d=b.lookupReference("template-mform");d||(d=Ext.create({xtype:"template-mform"}),c.add(d)),d.show()},onSaveBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromData(a.action,a.text,c,{url:"data/ajax.json?"+a.action})},onBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromIds(a.action,a.text,c,{url:"data/ajax.json?"+a.action})}}),Ext.define("Admin.view.template.TemplateMainGrid",{extend:"Admin.view.common.panel.BaseGridPanel",xtype:"template-mgrid",viewModel:{stores:{templateType:[[1,"文章模板"],[2,"栏目模板"],[3,"区块模板"],[4,"内嵌模板"]]}},initComponent:function(){var a=this,b=a.getViewModel();console.log(b.getStore("templateType")),Ext.apply(a,{store:Ext.create("Ext.data.Store",{proxy:{type:"ajax",url:"data/templates.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0}),columns:[{text:"模板ID",dataIndex:"id",width:100},{text:'名称 <span class="admin-color-red">+</span>',dataIndex:"name",editor:{xtype:"textfield",allowBlank:!1},flex:1},{text:'文件 <span class="admin-color-red">+</span>',dataIndex:"filename",editor:{xtype:"textfield",allowBlank:!1},width:250},{text:'模板类型 <span class="admin-color-red">+</span>',dataIndex:"type",editor:{xtype:"combo",store:[[1,"文章模板"],[2,"栏目模板"],[3,"区块模板"],[4,"内嵌模板"]],editable:!1,triggerAction:"all",forceSelection:!0,allowBlank:!1},renderer:a.renderer,width:250},{text:"导入者",dataIndex:"creator"},{text:"创建时间",dataIndex:"createDate",xtype:"datecolumn",format:"y-m-d H:i:s",width:150},{text:"状态",dataIndex:"status",renderer:a.renderer}],tbar:[{xtype:"button",text:"新增",iconCls:"x-fa fa-plus-circle",action:"add"},{xtype:"button",text:"保存",iconCls:"x-fa fa-floppy-o",disabled:!0,action:"save"},{xtype:"button",text:"删除",iconCls:"x-fa fa-trash-o",disabled:!0,action:"delete"},"-",{xtype:"button",text:"刷新",iconCls:"x-fa fa-refresh",action:"refresh"}],plugins:[{ptype:"cellediting",clicksToEdit:2}]}),a.callParent()},renderer:function(a,b,c,d,e,f,g){switch(this.getHeaderContainer().getHeaderAtIndex(e).dataIndex){case"status":switch(a){case 0:return b.tdStyle="color:#0066FF","内置";case 1:return b.tdStyle="color:green","启用"}case"type":return g.ownerGrid.getViewModel().getStore("templateType")[a-1][1];default:return a}}}),Ext.define("Admin.view.template.Template",{extend:"Ext.panel.Panel",xtype:"template",requires:[],uses:[],controller:"template",layout:"border",margin:5,initComponent:function(){var a=this;Ext.apply(a,{items:[{region:"center",xtype:"template-mgrid"}]}),a.callParent()}}),Ext.define("Admin.view.keyword.KeywordController",{extend:"Admin.controller.ViewController",alias:"controller.keyword",module:"keyword",url:"Super Awesome",control:{"keyword-mgrid":{selectionchange:"onSelectionChange"},"keyword-mgrid button[action=add]":{click:"onAddBtnClicked"},"keyword-mgrid button[action=save]":{click:"onSaveBtnClicked"},"keyword-mgrid button[action=delete]":{click:"onBtnClicked"},"keyword-mgrid button[action=refresh]":{click:"onRefreshBtnClicked"},"hotkeyword-grid button[action=refresh]":{click:"onRefreshBtnClicked"}},onSelectionChange:function(a,b,c){var d=this,e=d.getView(),f=(d.getViewModel(),d.module),g=e.down(f+d.getSearchGridSuffix()),h=b?b.length:0;0==h&&Ext.log("No selection"),g.down("button[action=save]").setDisabled(h<1),g.down("button[action=delete]").setDisabled(h<1)},onAddBtnClicked:function(a){var b=this,c=b.getView(),d=b.lookupReference("keyword-mform");d||(d=Ext.create({xtype:"keyword-mform"}),c.add(d)),d.show()},onSaveBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromData(a.action,a.text,c,{url:"data/ajax.json?"+a.action})},onBtnClicked:function(a){var b=this,c=a.up("grid");b.sendAjaxFromIds(a.action,a.text,c,{url:"data/ajax.json?"+a.action})}}),Ext.define("Admin.view.keyword.HotKeywordGrid",{extend:"Admin.view.common.panel.BaseGridPanel",xtype:"hotkeyword-grid",iconCls:"x-fa fa-free-code-camp",title:"热门标签",initComponent:function(){var a=this;Ext.apply(a,{store:Ext.create("Ext.data.Store",{proxy:{type:"ajax",url:"data/keywords.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0}),columns:[{text:"ID",dataIndex:"id",width:100},{text:"名称",dataIndex:"name",width:150},{text:"描述",dataIndex:"desc",flex:1},{text:"英文",dataIndex:"ename",width:250},{text:"计数",dataIndex:"counter"}],tbar:[{xtype:"button",text:"刷新",iconCls:"x-fa fa-refresh",action:"refresh"}]}),a.callParent()},renderer:function(a,b,c,d,e,f,g){switch(this.getHeaderContainer().getHeaderAtIndex(e).dataIndex){case"status":switch(a){case 0:return b.tdStyle="color:#0066FF","内置";case 1:return b.tdStyle="color:green","启用"}case"title":default:return a}}}),Ext.define("Admin.view.keyword.KeywordMainGrid",{extend:"Admin.view.common.panel.BaseGridPanel",xtype:"keyword-mgrid",iconCls:"x-fa fa-list-ul",title:"标签列表",initComponent:function(){var a=this;Ext.apply(a,{store:Ext.create("Ext.data.Store",{proxy:{type:"ajax",url:"data/keywords.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0}),columns:[{text:"ID",dataIndex:"id",width:60},{text:'名称 <span class="admin-color-red">+</span>',dataIndex:"name",editor:{xtype:"textfield",allowBlank:!1},width:150},{text:'描述 <span class="admin-color-red">+</span>',dataIndex:"desc",editor:{xtype:"textarea",allowBlank:!1},flex:1},{text:'英文 <span class="admin-color-red">+</span>',dataIndex:"ename",editor:{xtype:"textfield",allowBlank:!1},width:150},{text:"计数",dataIndex:"counter"}],tbar:[{xtype:"button",text:"新增",iconCls:"x-fa fa-plus-circle",action:"add"},{xtype:"button",text:"保存",iconCls:"x-fa fa-floppy-o",disabled:!0,action:"save"},{xtype:"button",text:"删除",iconCls:"x-fa fa-trash-o",disabled:!0,action:"delete"},"-",{xtype:"button",text:"刷新",iconCls:"x-fa fa-refresh",action:"refresh"}],plugins:[{ptype:"cellediting",clicksToEdit:2}]}),a.callParent()},renderer:function(a,b,c,d,e,f,g){switch(this.getHeaderContainer().getHeaderAtIndex(e).dataIndex){case"status":switch(a){case 0:return b.tdStyle="color:#0066FF","内置";case 1:return b.tdStyle="color:green","启用"}case"title":default:return a}}}),Ext.define("Admin.view.keyword.Keyword",{extend:"Ext.panel.Panel",xtype:"keyword",requires:[],uses:[],controller:"keyword",layout:"border",margin:5,initComponent:function(){var a=this;Ext.apply(a,{items:[{region:"center",height:"50%",xtype:"hotkeyword-grid"},{region:"south",height:"50%",xtype:"keyword-mgrid"}]}),a.callParent()}}),Ext.define("Admin.view.account.AccountController",{extend:"Admin.controller.ViewController",alias:"controller.account",module:"account",url:"Super Awesome",init:function(){console.log(this)},control:{},onEditBtnClicked:function(a){var b=this,c=b.getView(),d=c.down("form"),e=d.query('[itemId^="d-"]'),f=d.query('[itemId^="v-"]'),g=c.down('button[action="cancel"]'),h=c.down('button[action="submit"]');Ext.each(e,function(a,b,c){a.setHidden(!0)}),Ext.each(f,function(a,b,c){a.setHidden(!1)}),a.setHidden(!0),g.setHidden(!1),h.setHidden(!1)},onCancelBtnClicked:function(a){var b=this,c=b.getView(),d=c.down("form"),e=d.query('[itemId^="d-"]'),f=d.query('[itemId^="v-"]'),g=c.down('button[action="edit"]'),h=c.down('button[action="submit"]');Ext.each(e,function(a,b,c){a.setHidden(!1)}),Ext.each(f,function(a,b,c){a.setHidden(!0)}),a.setHidden(!0),h.setHidden(!0),g.setHidden(!1)},onEditSettingSubmitBtnClicked:function(a){var b=this,c=b.getView(),d=c.down("form").getForm();d.isValid()&&d.submit({url:"./userUpdate",method:"POST",submitEmptyText:!1,success:function(a,b){switch(b.result.result){case"success":Ext.Msg.alert("提示","更新成功",function(a,b,c){window.location.reload()}).setIcon(Ext.Msg.INFO);break;case"failed":Ext.Msg.alert("警告","更新失败").setIcon(Ext.Msg.WARNING)}},failure:function(a,b){Ext.Msg.alert("错误","服务器端异常，请联系管理员").setIcon(Ext.Msg.ERROR)}})},onEditPwdSubmitBtnClicked:function(a){var b=this,c=b.getView(),d=c.down("form").getForm();d.isValid()&&d.submit({url:"./userChangePassWord",method:"POST",submitEmptyText:!1,success:function(a,b){switch(b.result.result){case"success":Ext.Msg.alert("提示","更新成功").setIcon(Ext.Msg.INFO);break;case"failed":Ext.Msg.alert("警告","更新失败："+b.result.password).setIcon(Ext.Msg.WARNING)}},failure:function(a,b){Ext.Msg.alert("错误","服务器端异常，请联系管理员").setIcon(Ext.Msg.ERROR)}})}}),Ext.define("Admin.view.account.AccountEditSetting",{extend:"Ext.panel.Panel",xtype:"account-setting",requires:[],controller:"account",keyMap:{"CTRL+ENTER":"onEditSettingSubmitBtnClicked",scope:"controller"},initComponent:function(){var a=this,b={id:_am.currentUser.id,account:_am.currentUser.account,name:_am.currentUser.name,phone:_am.currentUser.phone,mail:_am.currentUser.mail,depict:_am.currentUser.depict};Ext.apply(a,{items:{xtype:"form",defaults:{anchor:"50%",labelAlign:"right",msgTarget:"side"},bodyPadding:10,buttonAlign:"left",border:!1,defaultType:"textfield",items:[{xtype:"displayfield",fieldLabel:"帐号",value:b.account},{xtype:"displayfield",itemId:"d-name",fieldLabel:"姓名",value:b.name},{xtype:"displayfield",itemId:"d-phone",fieldLabel:"手机",value:b.phone},{xtype:"displayfield",itemId:"d-email",fieldLabel:"邮箱",value:b.mail},{xtype:"displayfield",itemId:"d-desc",fieldLabel:"描述",value:b.depict},{itemId:"v-name",name:"name",beforeLabelTextTpl:'<span class="admin-color-red">* </span>',fieldLabel:"姓名",hidden:!0,allowBlank:!1,blankText:"请填写您的姓名",maxLength:20,maxLengthText:"姓名不能超过20个字",value:b.name},{itemId:"v-phone",vtype:"phone",name:"phone",fieldLabel:"手机",hidden:!0,value:b.phone},{itemId:"v-email",vtype:"email",name:"mail",fieldLabel:"邮箱",maxLength:50,maxLengthText:"邮箱不能超过50个字符",hidden:!0,value:b.mail},{itemId:"v-desc",xtype:"textarea",name:"depict",fieldLabel:"描述",maxLength:50,maxLengthText:"描述不能超过50个字符",hidden:!0,value:b.depict},{name:"account",hidden:!0,value:b.account},{name:"id",hidden:!0,value:b.id}],tbar:[{text:"修改",iconCls:"x-fa fa-pencil-square-o",action:"edit",handler:"onEditBtnClicked"},{text:"取消",iconCls:"x-fa fa-undo",hidden:!0,action:"cancel",handler:"onCancelBtnClicked"},{text:"更新",iconCls:"x-fa fa-floppy-o",tooltip:"快捷键：Enter",disabled:!0,formBind:!0,hidden:!0,action:"submit",handler:"onEditSettingSubmitBtnClicked"}]}}),a.callParent()}}),Ext.define("Admin.view.account.AccountEditPwd",{extend:"Ext.panel.Panel",xtype:"account-editpwd",requires:[],controller:"account",keyMap:{"CTRL+ENTER":"onEditPwdSubmitBtnClicked",scope:"controller"},initComponent:function(){var a=this;Ext.apply(a,{items:{xtype:"form",defaults:{anchor:"30%",labelAlign:"right",msgTarget:"side",beforeLabelTextTpl:'<span class="admin-color-red">* </span>'},bodyPadding:10,buttonAlign:"left",border:!1,defaultType:"textfield",items:[{inputType:"password",name:"old-password",beforeLabelTextTpl:'<span class="admin-color-red">* </span>',fieldLabel:"旧密码",allowBlank:!1,blankText:"请填写您的旧密码"},{inputType:"password",itemId:"new-password",name:"new-password",beforeLabelTextTpl:'<span class="admin-color-red">* </span>',fieldLabel:"新密码",allowBlank:!1,blankText:"6-20位，由数字、字母(大小写)、特殊符号构成",emptyText:"6-20位，由数字、字母(大小写)、特殊符号构成"},{vtype:"password",inputType:"password",initialPassField:"new-password",name:"re-password",beforeLabelTextTpl:'<span class="admin-color-red">* </span>',fieldLabel:"密码确认",allowBlank:!1,blankText:"再次输入新密码进行确认"},{name:"id",hidden:!0,value:_am.currentUser.id}],tbar:[{text:"更新",iconCls:"x-fa fa-floppy-o",tooltip:"快捷键：Enter",disabled:!0,formBind:!0,action:"submit",handler:"onEditPwdSubmitBtnClicked"}]}}),a.callParent()}}),Ext.define("Admin.view.auth.role.RoleController",{extend:"Admin.controller.ViewController",alias:"controller.auth-role",module:"auth-role",url:"Super Awesome",init:function(){console.log(this)},control:{"auth-role-mgrid":{selectionchange:"onSelectionChange"},"auth-role-mgrid button[action=add]":{click:"onAddBtnClicked"},"auth-role-mgrid button[action=edit]":{click:"onEditBtnClicked"},"auth-role-mgrid button[action=refresh]":{click:"onRefreshBtnClicked"}},onSelectionChange:function(a,b,c){var d=this,e=d.getView(),f=(d.getViewModel(),d.module),g=e.down(f+d.getSearchGridSuffix()),h=b?b.length:0;0==h&&Ext.log("No selection"),g.down("button[action=edit]").setDisabled(1!==h)},onAddBtnClicked:function(a){var b=this,c=b.getView(),d=b.lookupReference("auth-role-mform");d||(d=Ext.create({xtype:"auth-role-mform"}),c.add(d)),d.setTitle("新增"),d.show()},onEditBtnClicked:function(a){var b=this,c=b.getView(),d=b.lookupReference("auth-role-mform");d||(d=Ext.create({xtype:"auth-role-mform"}),c.add(d)),d.setTitle("修改"),d.show();var e=c.down("auth-role-mgrid"),f=e.getSelection()[0];d.down("form").getForm().loadRecord(f)},onSubmitBtnClicked:function(a){var b=this,c=b.getView(),d=c.down("form").getForm();b.formSubmit(d,{url:"data/ajax.json"},function(a,b){Ext.ux.Msg.info("保存成功",function(){c.hide();var a=c.up().down("auth-role-mgrid"),b=a.getStore();b.getProxy().setExtraParam("page",1),b.reload(),a.getSelectionModel().deselectAll()})})}}),Ext.define("Admin.view.auth.role.RoleMainGrid",{extend:"Admin.view.common.panel.BaseGridPanel",xtype:"auth-role-mgrid",actions:{preview:{iconCls:"x-fa fa-file-excel-o c-forestgreen",tooltip:"预览",handler:"onDownloadFileBtnClick"},add:{iconCls:"x-fa fa-file-excel-o c-forestgreen",tooltip:"新增子栏目",handler:"onDownloadFileBtnClick"},article:{iconCls:"x-fa fa-building",tooltip:"文章列表",handler:"onCreateOrderBtnClicked"},headline:{iconCls:"x-fa fa-search-plus",tooltip:"头条列表",handler:"onSearchOrderBtnClicked"},picture:{iconCls:"x-fa fa-calendar",tooltip:"图片列表",handler:"onAdInfoBtnClicked"}},initComponent:function(){var a=this;Ext.apply(a,{store:Ext.create("Ext.data.Store",{proxy:{type:"ajax",url:"data/roles.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0}),columns:[{text:"ID",dataIndex:"id",width:80},{text:"名称",dataIndex:"name"},{text:"级别",dataIndex:"rank"},{text:"描述",dataIndex:"depict",renderer:a.renderer,width:200},{text:"功能",dataIndex:"function_names",renderer:a.renderer,flex:1}],tbar:[{xtype:"button",text:"新增",iconCls:"x-fa fa-plus-circle",action:"add"},{xtype:"button",text:"修改",iconCls:"x-fa fa-pencil-square-o",disabled:!0,action:"edit"},"-",{xtype:"button",text:"刷新",iconCls:"x-fa fa-refresh",action:"refresh"}]}),a.callParent()},renderer:function(a,b,c,d,e,f,g){switch(this.getHeaderContainer().getHeaderAtIndex(e).dataIndex){case"depict":return b.tdAttr='data-qtip="'+a+'"',a;case"function_names":return b.tdAttr='data-qtip="'+a+'"',a.join(",");default:return a}}}),Ext.define("Admin.view.auth.role.RoleMainForm",{extend:"Admin.view.common.window.BaseFormWindow",xtype:"auth-role-mform",controller:"auth-role",maximizable:!1,initComponent:function(){var a=this,b=Ext.create({xtype:"form",layout:"anchor",bodyPadding:10,defaults:{anchor:"100%",labelWidth:60,labelAlign:"right",msgTarget:"side",beforeLabelTextTpl:'<span class="admin-color-red">* </span>'},defaultType:"textfield",items:[{fieldLabel:"roleId",name:"id",hidden:!0},{name:"name",fieldLabel:"名称",allowBlank:!1},{xtype:"numberfield",name:"rank",fieldLabel:"级别",allowBlank:!1,minValue:0},{xtype:"textarea",name:"depict",beforeLabelTextTpl:"",fieldLabel:"描述",maxLength:255},{xtype:"fieldcontainer",fieldLabel:"功能",layout:"fit",maxHeight:500,scrollable:"y",items:{xtype:"itemselector",name:"function_ids",itemId:"function_ids",width:"100%",imagePath:"../ux/images/",buttons:["add","remove"],buttonsText:["增加","删除"],store:{proxy:{type:"ajax",url:"data/functions.json",reader:{type:"json",rootProperty:"rows"}},autoLoad:!0},displayField:"name",valueField:"id",allowBlank:!1,msgTarget:"side"}}],buttons:[{text:"重置",iconCls:"x-fa fa-undo",action:"reset",handler:"onResetBtnClicked"},{text:"提交",iconCls:"x-fa fa-floppy-o",tooltip:"快捷键：Ctrl+Enter",disabled:!0,formBind:!0,action:"submit",handler:"onSubmitBtnClicked"}]});Ext.apply(a,{items:b}),a.callParent()}}),Ext.define("Admin.view.auth.role.Role",{extend:"Ext.panel.Panel",xtype:"auth-role",requires:[],uses:[],controller:"auth-role",layout:"border",margin:5,initComponent:function(){var a=this;Ext.apply(a,{items:[{region:"center",xtype:"auth-role-mgrid"}]}),a.callParent()}}),Ext.define("Admin.view.main.HomePage",{extend:"Ext.container.Container",xtype:"homepage",requires:[],layout:"responsivecolumn",items:[{xtype:"panel",title:"更新日志",html:"<ul><li>（1）登录 -> 1个页面；</li><li>（2）首页 -> 1个页面；unfinished:查看文章</li><li>（3）账户资料（资料设置、密码修改）-> 2个页面；</li><li>（4）栏目维护（目录维护、新增目录、模板维护、标签维护）-> 4个页面；</li><li>（5）内容管理（新增新闻）-> 1个页面；</li><li>（6）内容管理（新闻法讯 -> 图片头条、新闻法讯 -> 栏目图片列表） -> 2个页面；</li><li>（7）系统安全（角色管理）-> 1个页面；</li></ul>"}]}),Ext.define("Admin.store.Navigation",{extend:"Ext.data.TreeStore",alias:"store.navigation",storeId:"Navigation",filterer:"bottomup",constructor:function(a){var b=this,c=[],d=Ext.getVersion().parts;b.ver=new Ext.Version(d[0]+"."+d[1]+"."+d[2]),c.push(b.getNavItemsContentModule()),c.push(b.getNavItemsSeralModule()),c.push(b.getNavItemsReleaseModule()),c.push(b.getNavItemsCategoryModule()),c.push(b.getNavItemsMidiaModule()),c.push(b.getNavItemsAccountModule()),c.push(b.getNavItemsSystemModule()),c={text:"Login",viewType:"login",expanded:!0,iconCls:"x-fa fa-home",description:"<h2>Welcome To Admgr!</h2>此应用用于外购单管理!",children:c},b.fixUp(c),b.callParent([Ext.apply({root:c},a)])},fixUp:function(a,b,c){var d,e,f=this,g=a;if(Ext.isArray(a))for(d=a.length;d-- >0;)g=a[d],!1===g.compat?a.splice(d,1):(f.fixUp(g,b,c),c&&(g.isNew||g.hasNew)&&(c.hasNew=!0));else e=g.since,e&&(g.sinceVer=e=new Ext.Version(e),g.isNew=e.gtEq(f.ver)),b=g.tier||(g.tier=b||"standard"),"iconCls"in g||(g.iconCls="icon-"+g.id),g.children&&f.fixUp(g.children,b,g)},getNavItemsContentModule:function(){return{text:"内容管理",iconCls:"x-fa fa-newspaper-o",expanded:!0,children:[{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"首页",visible:!1,children:[{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"主导航",children:[{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"主导航修改",leaf:!0}]},{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"次导航",leaf:!0},{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"活动通知",leaf:!0},{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"广告管理",leaf:!0},{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"紫云法务",children:[{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"短期出家",children:[{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"短期出家修改",leaf:!0}]},{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"入寺须知",leaf:!0},{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"礼佛须右",leaf:!0}]},{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"广种福田",leaf:!0},{viewType:"report-outsource",iconCls:"x-fa fa-file-text-o",text:"联系我们",leaf:!0}]},{viewType:"content-news",iconCls:"x-fa fa-file-text-o",text:"新闻法讯",split:!0,leaf:!0},{viewType:"content-life",iconCls:"x-fa fa-file-text-o",text:"生活禅",split:!0,leaf:!0},{viewType:"content-ziyunfoguo",iconCls:"x-fa fa-file-text-o",text:"紫云佛国",split:!0,leaf:!0},{viewType:"content-",iconCls:"x-fa fa-file-text-o",text:"神医养生",split:!0,leaf:!0},{viewType:"content-knowledge",iconCls:"x-fa fa-file-text-o",text:"佛教常识",split:!0,leaf:!0},{viewType:"content-cangjingge",iconCls:"x-fa fa-file-text-o",
text:"藏经阁",split:!0,leaf:!0},{viewType:"content-law",iconCls:"x-fa fa-file-text-o",text:"紫云法务",split:!0,leaf:!0},{viewType:"content-shuimochanyun",iconCls:"x-fa fa-file-text-o",text:"水墨禅韵",split:!0,leaf:!0},{viewType:"content-recycle",iconCls:"x-fa fa-trash",text:"回收站",leaf:!0}]}},getNavItemsSeralModule:function(){return{text:"连载管理",iconCls:"x-fa fa-desktop",visible:!1,children:[{viewType:"log",iconCls:"x-fa fa-file-text-o",text:"连载列表",children:[{viewType:"debug",iconCls:"x-fa fa-file-text-o",text:"新增连载",leaf:!0}]}]}},getNavItemsReleaseModule:function(){return{text:"发布管理",iconCls:"x-fa fa-desktop",visible:!1,children:[{viewType:"basicData",iconCls:"x-fa fa-file-text-o",text:"发布记录",leaf:!0}]}},getNavItemsCategoryModule:function(){return{text:"栏目维护",iconCls:"x-fa fa-bars",children:[{viewType:"category",iconCls:"x-fa fa-file-text-o",text:"目录维护",leaf:!0},{viewType:"template",iconCls:"x-fa fa-file-text-o",text:"模板维护",leaf:!0},{viewType:"keyword",iconCls:"x-fa fa-file-text-o",text:"标签维护",leaf:!0}]}},getNavItemsMidiaModule:function(){return{text:"媒体管理",iconCls:"x-fa fa-cog",visible:!1,children:[{viewType:"basicData",iconCls:"x-fa fa-file-text-o",text:"图片",leaf:!0},{viewType:"site",iconCls:"x-fa fa-file-text-o",text:"音频",leaf:!0},{viewType:"setting",iconCls:"x-fa fa-file-text-o",text:"文档",leaf:!0}]}},getNavItemsAccountModule:function(){return{text:"帐户资料",iconCls:"x-fa fa-user",children:[{viewType:"account-setting",iconCls:"x-fa fa-file-text-o",text:"资料设置",leaf:!0},{viewType:"account-editpwd",iconCls:"x-fa fa-file-text-o",text:"密码修改",leaf:!0}]}},getNavItemsSystemModule:function(){return{text:"系统安全",iconCls:"x-fa fa-lock",children:[{viewType:"basicData",iconCls:"x-fa fa-file-text-o",text:"日志管理",leaf:!0,visible:!1},{viewType:"site",iconCls:"x-fa fa-file-text-o",text:"帐户管理",leaf:!0,visible:!1},{viewType:"auth-role",iconCls:"x-fa fa-file-text-o",text:"角色管理",leaf:!0},{viewType:"setting",iconCls:"x-fa fa-file-text-o",text:"权限管理",leaf:!0,visible:!1}]}},getNavItemsHiddenModule:function(){return{text:"隐藏菜单",iconCls:"x-fa fa-cog",description:"此处为隐藏菜单,包含各模块下的子模块,只为提供给hash路由时加载模块使用",children:[{viewType:"content-headline-text",iconCls:"x-fa fa-file-text-o",text:"文字头条",leaf:!0,visible:!1}]}}}),Ext.Loader.setConfig({disableCaching:!0}),Ext.QuickTips.init(),Ext.application({name:"Admin",requires:[],controllers:["AppController"],views:["common.window.BaseWindow","common.window.BaseFormWindow","common.panel.BaseGridPanel","common.panel.BaseSearchPanel","common.charts.BaseChart","main.Main","workbench.Workbench","content.Content","content.recycle.Recycle","category.Category","template.Template","keyword.Keyword","account.AccountEditSetting","account.AccountEditPwd","auth.role.Role","main.HomePage"],stores:["Navigation"],defaultToken:"",launch:function(){Ext.create("Admin.store.Navigation",{storeId:"navigation"});var a="Admin.view.main.Main";_am.currentUser.name?this.setMainView({xclass:a}):(a="Admin.view.auth.login.Login",Ext.create(a))},onAppUpdate:function(){Ext.Msg.confirm("Application Update","This application has an update, reload?",function(a){"yes"===a&&window.location.reload()})}});